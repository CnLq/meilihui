var str_result="";var str_isCheckAccount="";var loginbaseUrl=$("#contextPath").val();String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};$(document).ready(function(){isCheckCodeShow("","0");isCheckCodeShow_Reg("0");var a=$("#pages").val();var b="";b=getCookie("glms_uu");if(a!=="regist"){if(b===undefined||b===""||b===null){$("#userAccount").val("已验证手机号/邮箱")}else{$("#userAccount").val(b)}}if(a==="login"){showRandom()}});function isCheckCodeShow(a,b){$.ajax({url:loginbaseUrl+"/user/isCheckCodeShow?key="+a+"&pass_error="+b,type:"get",cache:false,async:false,success:function(c){$("#is_check_code_show").val(c);if(c==="0"){$("#rdm_img").addClass("hidstyle");$("#rdm_img").removeClass("showstyle")}else{if(c==="1"){$("#rdm_img").addClass("showstyle");$("#rdm_img").removeClass("hidstyle")}}},error:function(){}})}function isCheckCodeShow_Reg(a){var b=$("#is_reg").val();if(b==="1"){$.ajax({url:loginbaseUrl+"/user/isCheckCodeShow_Reg?pass_error="+a,type:"get",cache:false,async:false,success:function(c){if(c=="0"){$("#rdm_img").addClass("showstyle");$("#rdm_img").removeClass("hidstyle")}else{$("#rdm_img").addClass("hidstyle");$("#rdm_img").removeClass("showstyle")}},error:function(){}})}}function removeContent(){var a=$("input[name='userAccount']").val().trim();if(a==="已验证手机号/邮箱"||a==="手机号/邮箱"||a==="请输入您的手机号码"){$("input[name='userAccount']").val("")}}function removePwdContent(){$("#passWordtext").css("display","none");$("#passWord").css("display","block");$("#passWord").focus()}function toSubmit(d,p,g,s,n){var t=getCookie("subscripeEventIds");var r=getCookie("cookieSubPhone");if(d==="regist"){var h=$("#regist").attr("onclick");$("#regist").attr("onclick","")}var c=$("input[name='userAccount']").val();var j=$("input[name='passWord']").val();var i=$("#isRemenbered").val();var e=$("#isGetRemind").val();var q=checkFormInfo(d,p,g,s,n);var a="";var m="";var f="";if(q===false){if(d==="regist"){$("#regist").attr("onclick","toSubmit('regist','no')")}return false}else{if(d==="login"){isCheckCodeShow(c,"0");if($("#is_check_code_show").val()==="1"&&$("input[name='random']").val()==""){$("#rdm_img").find("#Rdm_error").text("请输入验证码");return false}$("#submitBtn").attr("disabled","true");$("#submitBtn").css("background-color","#999999");if(t==undefined||t==null){t=""}if(r==undefined||r==null){r=""}$.ajax({type:"post",datatype:"json",url:loginbaseUrl+"/user/tologin",success:function(u){a=u.result+"";m=u.errorTime+"";f=u.callBackUrl+"";if(a==="success"){if(i==="yes"){Setcookie("glms_uu",c)}else{Setcookie("glms_uu",c)}if(""!==f){window.location.href=base64decode(f)}else{window.location.href=loginbaseUrl+"/user/toMainPage"}Setcookie("isLogin","yes",60*60*1000);goldlogRecord("/mei.1.1","","type=page","H1703600")}else{if(a==="reset_pwd"){goldlogRecord("/mei.1.2","","type=page","H1703622");window.location.href=loginbaseUrl+"/user/resetPasswordNotification"}else{if(a==="double_check"){goldlogRecord("/mei.1.3","","type=page","H1703623");if(""!==f){window.location.href=f}else{window.location.href=loginbaseUrl+"/user/toMainPage"}}else{if(a==="is_forbidden"){$("#Pwd_error").text("您的账户已被禁用！");$("#rdm").click();if(m!=="undefined"&&m!==null&&m!==""){showRandom(m)}$("#submitBtn").attr("disabled","false");$("#submitBtn").removeAttr("disabled");$("#submitBtn").css("background-color","#DB2725");goldlogRecord("/mei.1.4","","type=page","H1703624")}else{if(a==="is_locked"){$("#Pwd_error").text("出于安全考虑，系统已冻结您的账户，请联系客服：400-664-6698");$("#rdm").click();if(m!=="undefined"&&m!==null&&m!==""){showRandom(m)}$("#submitBtn").attr("disabled","false");$("#submitBtn").removeAttr("disabled");$("#submitBtn").css("background-color","#DB2725");goldlogRecord("/mei.1.5","","type=page","H1703625")}else{$("#Pwd_error").text("账户名或密码错误");$("#rdm").click();if(m!=="undefined"&&m!==null&&m!==""){showRandom(m)}$("#submitBtn").attr("disabled","false");$("#submitBtn").removeAttr("disabled");$("#submitBtn").css("background-color","#DB2725");goldlogRecord("/mei.1.6","","type=page","H1703626")}}}}}},error:function(){a="fail";$("#submitBtn").attr("disabled","false");$("#submitBtn").removeAttr("disabled");$("#submitBtn").css("background-color","#DB2725");goldlogRecord("/mei.1.7","","type=page","H1703627")},data:{userAccount:c,passWord:j,cookieSub:t,cookieSubPhone:r,emailRandom:$("input[name='random']").val(),isRemenbered:i}})}else{var b=encodeURIComponent(getCookie("__utmz"));var k=getCookie("pid");if(k==null||k==undefined||k==""){k=""}var o=getCookie("clk1");if(o==null||o==undefined||o==""){o=""}var l=encodeURIComponent('{"pid":"'+k+'","clk1":"'+o+'"}');$.ajax({type:"post",datatype:"json",async:false,url:loginbaseUrl+"/user/toregist",success:function(u){a=u.result;if(a==="success"){Setcookie("glms_uu",c);goldlogRecord("http://cdn11.mei.com/mei.2.11","","type=page","H1733391");if(c.indexOf("@")>0){window.location.href=loginbaseUrl+"/user/toValidataPhone"}else{if(undefined!=u.mxeventurl&&null!=u.mxeventurl&&""!=u.mxeventurl){window.location.href=u.mxeventurl}else{window.location.href=loginbaseUrl+"/personInfo/showPersonInfo"}}}else{var v="注册失败！";if(a=="isExistedAccount"){v="注册账户已存在，请重新注册！";goldlogRecord("http://cdn11.mei.com/mei.2.13","","type=page","H1733414")}else{if(a=="wrongValiatedCode"){v="验证码有误！";goldlogRecord("http://cdn11.mei.com/mei.2.14","","type=page","H1733415")}else{if(a=="noIdenticalMobile"){v="手机号与验证码不匹配！";goldlogRecord("http://cdn11.mei.com/mei.2.15","","type=page","H1733416")}else{if(a=="wrongRegist"){goldlogRecord("http://cdn11.mei.com/mei.2.16","","type=page","H1733417");v="非正常注册！"}else{if(a=="ipLimitCount"){v="IP超限，请明天再注册！"}else{goldlogRecord("http://cdn11.mei.com/mei.2.12","","type=page","H1733413")}}}}}$("#regist").attr("onclick","toSubmit('regist','no')");wait=0;if(c.indexOf("@")>0){$("#Act_error").text(v)}else{$("#rdm_tel").find("#Rdm_error").text(v)}setTimeout(function(){$(".Rdm_error").text("")},5000)}},error:function(){a="fail";goldlogRecord("http://cdn11.mei.com/mei.2.18","","type=page","H1733419")},data:{userAccount:c,passWord:j,isGetRemind:e,userId:$("#userId").val(),type:$("#type").val(),platform:$("#platform").val(),phoneRandom:$("#validateCode").val(),emailRandom:$("input[name='random']").val(),utmz:b,followJsonStr:l}})}}}function tosendEmail(a){$.ajax({type:"post",datatype:"json",async:false,url:loginbaseUrl+"/user/tosendEmail",success:function(b){},error:function(){},data:{registNo:a}})}function sendMessageCode(){$("#validateCode").click();goldlogRecord("http://cdn11.mei.com/mei.2.17","","type=page","H1733418");checkFormInfo("regist","no","send","","")}function checkFormInfo(h,b,n,o,e){str_isCheckAccount=b;var c=$("input[name='userAccount']").val();var j=$("input[name='passWord']").val();var k=$("input[name='random']").val();var g=$("#rdm_img").attr("class");var m=$("#rdm_tel").attr("class");var a=$(".sendRandm").attr("class");var i=$(".rsendRandm").attr("class");var l=$(".ma").attr("class");if(o==="yes"){if(!checkmgmAccount(c.trim(),h,g,m)){return false}else{if(e==="account"){return false}}}else{if(!checkAccount(c.trim(),h,g,m)){return false}else{if(e==="account"){return false}}}if(h==="regist"&&c.indexOf("@")<=0&&$("#randomTelCheckCode").val()==""){var f="";$.ajax({type:"post",datatype:"json",async:false,url:loginbaseUrl+"/user/toGetRandomTelCheckCode",success:function(p){f=p;$("#randomTelCheckCode").val(p)},error:function(){f="fail"}})}if(!checkPassWord(j.trim(),h)){return false}else{if(e==="pwd"){return false}}if(h==="regist"){var d=$("input[name='rpassWord']").val();if(!checkRPassword(d.trim(),j.trim())){return false}else{if(e==="rpwd"){return false}}}if(g==="showstyle"||m==="showstyle"||a==="showstyle"||i==="showstyle"||l==="showstyle"){k=$("input[name='random']").val();if(e==="random"&&!checkRandom(k,e)){return false}k=$("input[name='random1']").val();if(e==="random1"&&!checkRandom(k,e)){return false}}if(h==="regist"&&n==="send"){toSendSMS(h);return false}return true}function showRandom(d){var b=$("#is_check_code_show").val();var e=d;var a=$("#errorGetRDM").val();var c=$("#errorGetLock").val();if(typeof(e)==="undefined"){e=0}if(b==="1"){$("#rdm_img").addClass("showstyle");$("#rdm_img").removeClass("hidstyle")}else{if(b==="0"){$("#rdm_img").addClass("hidstyle");$("#rdm_img").removeClass("showstyle")}}if(parseInt(e)>=parseInt(c)){$("#Pwd_error").text("");$("#lockInfo").addClass("showstyle");$("#lockInfo").removeClass("hidstyle");$("#Act_error").text("");$("#TelIsHad").addClass("hidstyle");$("#TelIsHad").removeClass("showstyle");$("#EmailIsHad").addClass("hidstyle");$("#EmailIsHad").removeClass("showstyle")}else{$("#lockInfo").addClass("hidstyle");$("#lockInfo").removeClass("showstyle")}}function checkmgmAccount(e,d,a,b){var f=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;var g=/^[0-9]{11}$/;if(e===""||e===null||e==="请输入您的手机号码"||e==="手机号/邮箱"){if(d==="login"){$("#Act_error").text("请输入已验证的手机号或邮箱")}else{$("#Act_error").text("请输入手机号")}$("#Pwd_error").text("");$("#lockInfo").addClass("hidstyle");$("#lockInfo").removeClass("showstyle");$("#TelIsHad").addClass("hidstyle");$("#TelIsHad").removeClass("showstyle");$("#EmailIsHad").addClass("hidstyle");$("#EmailIsHad").removeClass("showstyle");return false}else{if(a==="showstyle"||b==="showstyle"){if(d!=="login"){$("#rdm_tel").addClass("showstyle");$("#rdm_tel").removeClass("hidstyle")}}if(e.length!==11){$("#Act_error").text("请输入正确的手机号");$("#TelIsHad").addClass("hidstyle");$("#TelIsHad").removeClass("showstyle");$("#EmailIsHad").addClass("hidstyle");$("#EmailIsHad").removeClass("showstyle");$("#Pwd_error").text("");$("#lockInfo").addClass("hidstyle");$("#lockInfo").removeClass("showstyle");return false}else{if(g.test(e)){if(d==="login"){var c="";c=AccountIsHad(e);if(c.trim().toString()==="yeslock"){$("#Act_error").text("抱歉您的账号已被冻结，请联系客服：400-664-6698");$("#TelIsHad").addClass("hidstyle");$("#TelIsHad").removeClass("showstyle");$("#EmailIsHad").addClass("hidstyle");$("#EmailIsHad").removeClass("showstyle");$("#Pwd_error").text("");$("#lockInfo").addClass("hidstyle");$("#lockInfo").removeClass("showstyle");return false}else{$("#Act_error").text("")}}else{return isHadAcc(e)}}else{$("#Act_error").text("请输入正确的手机号");$("#TelIsHad").addClass("hidstyle");$("#TelIsHad").removeClass("showstyle");$("#EmailIsHad").addClass("hidstyle");$("#EmailIsHad").removeClass("showstyle");$("#Pwd_error").text("");$("#lockInfo").addClass("hidstyle");$("#lockInfo").removeClass("showstyle");return false}}}return true}function checkAccount(e,d,a,b){var f=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;var g=/^[0-9]{11}$/;if(e===""||e===null||e==="已验证手机号/邮箱"||e==="手机号/邮箱"){if(d==="login"){$("#Act_error").text("请输入已验证的手机号或邮箱")}else{$("#Act_error").text("请输入手机号或邮箱")}$("#Pwd_error").text("");$("#lockInfo").addClass("hidstyle");$("#lockInfo").removeClass("showstyle");$("#TelIsHad").addClass("hidstyle");$("#TelIsHad").removeClass("showstyle");$("#EmailIsHad").addClass("hidstyle");$("#EmailIsHad").removeClass("showstyle");return false}else{if(f.test(e)){if(a==="showstyle"||b==="showstyle"){if(d!=="login"){$("#rdm_tel").addClass("hidstyle");$("#rdm_tel").removeClass("showstyle")}}if(a==="showstyle"||b==="showstyle"){if(d!=="login"){$("#rdm_tel").addClass("hidstyle");$("#rdm_tel").removeClass("showstyle")}}if(d==="login"){var c="";c=AccountIsHad(e);if(c.trim().toString()==="yeslock"){$("#Act_error").text("抱歉您的账号已被冻结，请联系客服：400-664-6698");$("#Pwd_error").text("");$("#lockInfo").addClass("hidstyle");$("#lockInfo").removeClass("showstyle");$("#TelIsHad").addClass("hidstyle");$("#TelIsHad").removeClass("showstyle");$("#EmailIsHad").addClass("hidstyle");$("#EmailIsHad").removeClass("showstyle");return false}else{$("#Act_error").text("")}}else{if(d==="regist"){$("#Act_error").text("");return isHadAcc(e)}}}else{if(a==="showstyle"||b==="showstyle"){if(d!=="login"){$("#rdm_tel").addClass("showstyle");$("#rdm_tel").removeClass("hidstyle")}}if(e.length!==11){$("#Act_error").text("请输入正确的手机号或邮箱");$("#TelIsHad").addClass("hidstyle");$("#TelIsHad").removeClass("showstyle");$("#EmailIsHad").addClass("hidstyle");$("#EmailIsHad").removeClass("showstyle");$("#Pwd_error").text("");$("#lockInfo").addClass("hidstyle");$("#lockInfo").removeClass("showstyle");return false}else{if(g.test(e)){if(d==="login"){var c="";c=AccountIsHad(e);if(c.trim().toString()==="yeslock"){$("#Act_error").text("抱歉您的账号已被冻结，请联系客服：400-664-6698");$("#TelIsHad").addClass("hidstyle");$("#TelIsHad").removeClass("showstyle");$("#EmailIsHad").addClass("hidstyle");$("#EmailIsHad").removeClass("showstyle");$("#Pwd_error").text("");$("#lockInfo").addClass("hidstyle");$("#lockInfo").removeClass("showstyle");return false}else{$("#Act_error").text("")}}else{return isHadAcc(e)}}else{$("#Act_error").text("请输入正确的手机号或邮箱");$("#TelIsHad").addClass("hidstyle");$("#TelIsHad").removeClass("showstyle");$("#EmailIsHad").addClass("hidstyle");$("#EmailIsHad").removeClass("showstyle");$("#Pwd_error").text("");$("#lockInfo").addClass("hidstyle");$("#lockInfo").removeClass("showstyle");return false}}}}return true}function isHadAcc(b){var a="";a=AccountIsHad(b);if(a.trim().toString()==="yes"||a.trim().toString()==="yeslock"){if(b.indexOf("@")>0){$("#EmailIsHad").addClass("showstyle");$("#EmailIsHad").removeClass("hidstyle");$("#TelIsHad").addClass("hidstyle");$("#TelIsHad").removeClass("showstyle")}else{$("#TelIsHad").addClass("showstyle");$("#TelIsHad").removeClass("hidstyle");$("#EmailIsHad").addClass("hidstyle");$("#EmailIsHad").removeClass("showstyle")}$("#Act_error").text("");$("#Pwd_error").text("");$("#lockInfo").addClass("hidstyle");$("#lockInfo").removeClass("showstyle");return false}else{if(a.trim().toString()==="no"){if(b.indexOf("@")>0){isCheckCodeShow_Reg("0")}else{$("#rdm_img").addClass("hidstyle");$("#rdm_img").removeClass("showstyle");$("#rdm_tel").addClass("showstyle");$("#rdm_tel").removeClass("hidstyle")}$("#Act_error").html("");$("#TelIsHad").addClass("hidstyle");$("#TelIsHad").removeClass("showstyle");$("#EmailIsHad").addClass("hidstyle");$("#EmailIsHad").removeClass("showstyle");return true}else{$("#Act_error").text("网络异常，请刷新网站试试吧");$("#TelIsHad").addClass("hidstyle");$("#TelIsHad").removeClass("showstyle");$("#EmailIsHad").addClass("hidstyle");$("#EmailIsHad").removeClass("showstyle");$("#Pwd_error").text("");$("#lockInfo").addClass("hidstyle");$("#lockInfo").removeClass("showstyle");return false}}}function checkPassWord(a,b){if(a===""||a===null){$("#Pwd_error").text("请输入密码");$("#lowPwd").text("");return false}else{if(b=="regist"){if(a.length<6){$("#Pwd_error").text("密码长度不能少于6位");$("#lowPwd").text("");return false}else{$("#Pwd_error").text("")}}else{$("#Pwd_error").text("")}}return true}function isRemenber(){var a=$("#isRemenber").attr("class");if(a.indexOf("not_selected")>0){$("#isRemenber").addClass("selected");$("#isRemenber").removeClass("not_selected");$("#isRemenbered").val("yes")}else{$("#isRemenber").addClass("not_selected");$("#isRemenber").removeClass("selected");$("#isRemenbered").val("no")}}$(document).ready(function(){$("input.yanzheng").keypress(function(a){if(a.which==13){toSubmit("regist","no")}})});function toAlipayLogin(){goldlogRecord("/mei.1.9","","type=page","H1703629");window.location.href=loginbaseUrl+"/user/toAlipayLogin"}function toweiboLogin(){var a="";goldlogRecord("/mei.1.8","","type=page","H1703628");$.ajax({type:"post",datatype:"json",async:false,url:loginbaseUrl+"/user/toSinaWeibo",success:function(b){a=b.result+""}});if(a!==null){location.href=a}}function isGetRemind(){var a=$("#chooseRemind").attr("class");if(a.indexOf("not_selected")>0){$("#chooseRemind").addClass("selected");$("#chooseRemind").removeClass("not_selected");$("#isGetRemind").val("yes")}else{$("#chooseRemind").addClass("not_selected");$("#chooseRemind").removeClass("selected");$("#isGetRemind").val("no")}}$("#userAccount").keyup(function(){var b=$("#userAccount").val();var a=$("#userAccount").val().replace(/[^\w\@\.\~\!\#\$\%\&\*\_\-\?\？\'\`/]/ig,"");if(b!=a){$("#userAccount").val(a)}});