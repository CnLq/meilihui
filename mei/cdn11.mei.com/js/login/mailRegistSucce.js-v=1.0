var loginbaseUrl=$("#contextPath").val();$().ready(function(){$.ajax({type:"post",datatype:"json",async:false,url:$("#contextPath").val()+"/user/getPromotionContent4Popup",success:function(a){$("#popupPromotionContent").html(a.promotionContent)},error:function(){str_reuslt="fail"}})});function revemovMailContent(a){if(a!=="regist"){var b=$.trim($("#bodyDivID").find("#phoneNum1").val());if(b=="请输入您的手机号码"){$("#bodyDivID").find("#phoneNum1").val("")}$("#bodyDivID").find("#phone_error1").text("")}else{var b=$.trim($("#phoneNum").val());if(b=="请输入您的手机号码"){$("#phoneNum").val("")}$("#phone_error").text("")}}function checkPhoneInfo(b){var a=/^[0-9]{11}$/;var c=$.trim($("#phoneNum").val());if(b==="regist"){c=$.trim($("#phoneNum").val())}else{c=$.trim($("#bodyDivID").find("#phoneNum1").val())}if(c.length<1){$("#phone_error").text("请输入正确的手机号码");if(b!=="regist"){$("#bodyDivID").find("#phone_error1").text("请输入正确的手机号码")}return false}if(!a.test(c)){$("#phone_error").text("请输入正确的手机号");if(b!=="regist"){$("#bodyDivID").find("#phone_error1").text("请输入正确的手机号")}return false}if(a.test(c)){return ajaxIsTiePhone(c,b)}return true}function tosubmit(g,h){var d=checkphoneCodeInfo(g,h);var b=$("#phoneNum").val();var f=$("#validateCode").val();if(g!="regist"){b=$("#bodyDivID").find("#phoneNum1").val();f=$("#bodyDivID").find("#validateCode1").val()}var a="";var e="";if(d){$.ajax({type:"post",datatype:"json",async:false,url:$("#contextPath").val()+"/user/toBindTelPhone",success:function(i){a=i.result;e=i.mxeventurl},error:function(){str_reuslt="fail"},data:{phoneRandom:f,telPhone:b}})}else{return false}if(a=="success"){if(g!=="regist"){_closeDialog()}else{if(undefined!=e&&null!=e&&""!=e){window.location.href=e}else{var c=$("#homePageFlg").val();if(c=="tiaoShouYe"){window.location.href=$("#contextPath").val()+"/index.html"}else{window.location.href=$("#contextPath").val()+"/personInfo/showPersonInfo"}}}}else{$(".Rdm_error1").text("验证失败！");setTimeout(function(){$(".Rdm_error1").text("")},5000)}}function checkphoneCodeInfo(d,h){var f=$("input[name='random1']").val();var c=$("#rdm_img").attr("class");var i=$("#rdm_tel").attr("class");var a=$(".sendRandm").attr("class");var e=$(".rsendRandm").attr("class");var g=$(".ma").attr("class");if(d==="regist"){f=$("input[name='random1']").val();c=$("#rdm_img").attr("class");i=$("#rdm_tel").attr("class");a=$(".sendRandm").attr("class");e=$(".rsendRandm").attr("class");g=$(".ma").attr("class")}else{f=$("#bodyDivID").find("#validateCode1").val();c=$("#bodyDivID").find("#rdm_img").attr("class");i=$("#bodyDivID").find("#rdm_tel").attr("class");a=$("#bodyDivID").find(".sendRandm").attr("class");e=$("#bodyDivID").find(".rsendRandm").attr("class");g=$("#bodyDivID").find(".ma").attr("class")}var b="";if((d==="regist"||d==="popregist")&&$("#randomTelCheckCode").val()==""){$.ajax({type:"post",datatype:"json",async:false,url:loginbaseUrl+"/user/toGetRandomTelCheckCode",success:function(j){b=j;$("#randomTelCheckCode").val(j)},error:function(){b="fail"}})}if(!checkPhoneInfo(d)){return false}if(h==="send"){toSendSMSs(d)}if(!checkRandoms(f,d)){return false}return true}function toSendSMSs(c){start();$.ajax({type:"post",datatype:"json",async:false,url:$("#contextPath").val()+"/user/getPhoneValidateCode",success:function(e){},error:function(){str_reuslt="fail"}});var a=null;var d=$("#phoneNum").val();if(c==="regist"){}else{d=$("#bodyDivID").find("#phoneNum1").val()}var b=$("#randomTelCheckCode").val();$.ajax({type:"post",datatype:"json",async:false,url:$("#contextPath").val()+"/user/toSendOtherSMS",success:function(e){a=e.result;$("#randomTelCheckCode").val(e.randomTelCheckCode)},error:function(){str_reuslt="fail"},data:{tel_no:d,sendtype:"regist",randomTelCheckCode:b}})}function ajaxIsTiePhone(c,b){var a="";$.ajax({type:"POST",url:$("#contextPath").val()+"/user/isTiePhone",dataType:"json",async:false,cache:false,data:{phoneNum:c},success:function(d){a=d.isAlrd},error:function(d,f,e){}});if(a!==0){$("#phone_error").text("该手机号已存在，请更换其它手机号！");if(b!=="regist"){$("#bodyDivID").find("#phone_error1").text("该手机号已存在，请更换其它手机号！")}return false}else{return true}}function ajaxTiePhone(a){$.ajax({type:"POST",url:"tiePhone",dataType:"json",cache:false,async:false,data:a,success:function(c){if(c.is_update>0){_closeDialog();var b=new CustomdDialogPlugins();b.btnClick("tieSucc");$("#showDivDialog .complete span").text(c.phone_no);$("#showDivDialog .button3").click(function(){_closeDialog();window.location.href=$(contextPath).val()+"/personInfo/showPersonInfo"})}},error:function(b,d,c){}})}function checkRandoms(a,b){if(a===""||a===null){$("#rdm_tel").find("#Rdm_error").text("请输入您收到的短信验证码");if(b!=="regist"){$("#bodyDivID").find("#rdm_tel").find("#Rdm_error").text("请输入您收到的短信验证码")}return false}else{var c=a;if(c.length===5){$("#rdm_tel").find("#Rdm_error").text("");if(b!=="regist"){$("#bodyDivID").find("#rdm_tel").find("#Rdm_error").text("")}var d=null;$.ajax({type:"post",datatype:"json",async:false,url:$("#contextPath").val()+"/user/toCheckRandom",success:function(e){d=e.result},error:function(){d="fail"},data:{random:a}});if(d==="yes"){$("#rdm_tel").find("#Rdm_error").text("");if(b!=="regist"){$("#bodyDivID").find("#rdm_tel").find("#Rdm_error").text("")}return true}else{$("#rdm_tel").find("#Rdm_error").text("请输入正确的验证码");if(b!=="regist"){$("#bodyDivID").find("#rdm_tel").find("#Rdm_error").text("请输入正确的验证码")}return false}}else{$("#rdm_tel").find("#Rdm_error").text("请输入正确的验证码");if(b!=="regist"){$("#bodyDivID").find("#rdm_tel").find("#Rdm_error").text("请输入正确的验证码")}return false}}return true}function getCookie(e){var d=document.cookie;var b=d.indexOf(e);if(b!=-1){b+=e.length+1;var c=d.indexOf(";",b);if(c==-1){c=d.length}var a=unescape(d.substring(b,c))}return a};